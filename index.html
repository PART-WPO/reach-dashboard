<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>WPO REACH Dashboard</title>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
  <link rel="stylesheet" href="style.css">
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/litepicker/dist/css/litepicker.css" />
<script src="https://cdn.jsdelivr.net/npm/litepicker/dist/bundle.js"></script>
  
</head>
<body>
  <div class="dashboard-container">
    <div class="header">
      <div class="title-with-logo">
        <img src="data:image/png;base64,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" alt="WPO logo" class="logo">
        <h1>Research Explorer for Articles, Code, & Hosted Data (REACH)</h1>
      </div>
      <div class="title-underline"></div>

    <div class="top-row">
       <!-- Column 1: Intro Text -->
      <div class="top-col intro-text">
        <p>
          The REACH tool is designed to increase access to and visibility of research outputs funded by the Weather Program Office (WPO). By providing public access to research articles, code, instruments, and datasets, REACH supports WPO's open science initiative, enhancing collaboration, knowledge-sharing, and the use of research findings in practice.
          <br><br>
          <strong>Start exploring WPO-funded research now—search for articles, code, instruments, and datasets using the search fields and filters below.</strong>
        </p>
      </div>
  <!-- Column 2: Output Widget -->
      <div class="output-widget">
        <div class="widget-title">Total<br>Outputs</div>
        <div class="output-number-box">
          <div id="output-count" class="output-number">0</div>
        </div>
      </div>
<!-- Column 3: Contact + Feedback Widgets -->
      <div class="top-col contact-feedback">
        <div class="widget contact-widget">
          <h3 class="widget-header"><strong>Contact Information:</strong></h3>
          <p>PART Program<br>
          <a href="mailto:part.wpo@noaa.gov" style="text-decoration: underline;">part.wpo@noaa.gov</a></p>
        </div>
        <div class="widget feedback-widget">
          <div class="widget-content">
            <h3 class="widget-header"><strong>Have feedback for us?</strong></h3>
            <p>
              Submit your feedback through our<br>
              <a href="https://forms.gle/RV3HyXy9s8B2cEfY8" target="_blank" style="text-decoration: underline;">Google Form</a>!
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Filters -->
    <div class="filters-container">
        <!-- Row 1 -->
      <div class="filter-row three-columns">
        <div class="filter-group">
          <label for="search">Search</label>
          <input type="text" id="searchInput" placeholder="Search by Keyword">
        </div>
        <div class="filter-group">
          <label for="searchAwardNumber">Search by Award Number</label>
          <input type="text" id="searchAwardNumber" placeholder="Search by Award Number">
        </div>
        <div class="filter-group">
    <label for="programFilter">Funded By</label>
          <select id="programFilter">
            <option value="">All Programs</option>
            <option value="Earth Prediction Innovation Center (EPIC)">EPIC</option>
            <option value="Joint Technology Transfer Initiative (JTTI)">JTTI</option>
            <option value="Observations">Observations</option>
            <option value="Social Science">Social Science</option>
            <option value="Subseasonal to Seasonal (S2S)">S2S</option>
            <option value="Synoptic">Synoptic</option>
            <option value="Testbeds">Testbeds</option>
            <option value="VORTEX">VORTEX</option>
          </select>
        </div>
      </div>

      <div class="filter-row five-columns second-row">
  <div class="filter-group">
    <label for="outputTypeFilter">Output Type</label>
    <select id="outputTypeFilter">
      <option value="">All Output Types</option>
      <option value="1">Journal Articles or Publications</option>
      <option value="2">Code Releases</option>
      <option value="3">Data & Instruments</option>
      <option value="4">Other Outputs</option>
    </select>
  </div>
  <div class="filter-group">
    <label for="openAccessFilter">Open Access Status</label>
    <select id="openAccessFilter">
      <option value="">Show All</option>
      <option value="Open Access">Open Access</option>
      <option value="Not Open Access">Not Open Access</option>
    </select>
  </div>
  <div class="filter-group">
    <label for="dateRange">Date Range</label>
    <input type="text" id="dateRange" placeholder="Eg: 05-25-2025 - 06-25-2025" />
  </div>
  <div class="filter-group">
    <button class="reset-btn" onclick="resetFilters()"><span class="material-icons">refresh</span>Reset</button>
  </div>
  <div class="filter-group">
    <button onclick="downloadCSV()" class="download-btn"><span class="material-icons">download</span>Download</button>
  </div>
</div>
      </div>
<p id="noResultsMessage" class="no-results">
  <span class="no-results-title">No results found.</span>
  <br>
  Nothing is turning up with that word, phrase, or award number. Please check your filters or try something else.
</p>
  <div class="cards-grid" id="cardsContainer"></div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
<script>
  const csvUrl = 'https://raw.githubusercontent.com/PART-WPO/reach-dashboard/refs/heads/main/Open%20Science%20Report%20(GitHub)%20-%20Open%20Science%20Report%20(1).csv';
  let picker;
  let allData = [];
  const text = v => (v ?? "").toString().trim();
const truthy = v => /^(true|yes|1|y)$/i.test(text(v));
const get = (row, keys) => {
  for (const k of keys) if (k in row && text(row[k]) !== "") return row[k];
  return "";
};

  // Debounce utility
  function debounce(func, delay) {
    let timeout;
    return function () {
      clearTimeout(timeout);
      timeout = setTimeout(() => func.apply(this, arguments), delay);
    };
  }

  function fetchData() {
  Papa.parse(csvUrl, {
    download: true,
    header: true,
    encoding: "UTF-8",
    complete: function(results) {
      allData = results.data;
      // ✅ Sort by most recent date before initial render
  allData.sort((a, b) => {
    const parse = (d) => {
      const date = new Date(d);
      return isNaN(date) ? new Date(0) : date;
    };
    return parse(b["Journal Pub Date"]) - parse(a["Journal Pub Date"]);
  });

  populateDropdowns();
  renderCards(allData);
  attachEventListeners();
      // ✅ Initialize Litepicker AFTER data loads and input is present
      picker = new Litepicker({
        element: document.getElementById('dateRange'),
        singleMode: false,
        format: 'MM-DD-YYYY',
        allowRepick: true,
        setup: (pickerInstance) => {
          pickerInstance.on('selected', () => filterData());
          
        }

      });
       document.getElementById("dateRange")?.addEventListener("input", debounce(() => {
  filterData();
  updateURLParams();
}, 300));
      
  applyURLParams();
    }
  });
}

  function applyURLParams() {
  const params = new URLSearchParams(window.location.search);

  if (params.has("keyword")) document.getElementById("searchInput").value = params.get("keyword");
  if (params.has("award")) document.getElementById("searchAwardNumber").value = params.get("award");
  if (params.has("outputType")) document.getElementById("outputTypeFilter").value = params.get("outputType");
  if (params.has("program")) document.getElementById("programFilter").value = params.get("program");
  if (params.has("openAccess")) document.getElementById("openAccessFilter").value = params.get("openAccess");
  if (params.has("dateRange")) {
    const val = params.get("dateRange");
    document.getElementById("dateRange").value = val;
    if (picker) {
      const [start, end] = val.split(" - ");
      picker.setDateRange(start, end);
    }
  }

  filterData(); // Trigger filtering based on populated fields
}
  
  function populateDropdowns() {
  const programs = new Set();
  allData.forEach(row => {
    const p = text(row["Funded By"]);
    if (p) programs.add(p);
  });

  const programFilter = document.getElementById("programFilter");
  // Keep your static options; just append any not already present
  const existing = new Set(Array.from(programFilter.options).map(o => o.value));
  programs.forEach(prog => {
    if (!existing.has(prog)) {
      const option = document.createElement("option");
      option.value = prog;
      option.textContent = prog;
      programFilter.appendChild(option);
    }
  });
}

  function attachEventListeners() {
    document.getElementById("searchInput")?.addEventListener("input", debounce(() => {
  filterData();
  updateURLParams();
}, 300));
    document.getElementById("searchAwardNumber")?.addEventListener("input", debounce(() => {
  filterData();
  updateURLParams();
}, 300));
   document.getElementById("outputTypeFilter")?.addEventListener("change", debounce(() => {
  filterData();
  updateURLParams();
}, 300));
   document.getElementById("programFilter")?.addEventListener("change", debounce(() => {
  filterData();
  updateURLParams();
}, 300));
    document.getElementById("openAccessFilter")?.addEventListener("change", debounce(() => {
  filterData();
  updateURLParams();
}, 300));
  }

  function filterData() {
    const keywordQuery = document.getElementById('searchInput')?.value.toLowerCase().trim() || "";
    const awardSearch = document.getElementById("searchAwardNumber")?.value.toLowerCase().trim() || "";
    const outputType = document.getElementById("outputTypeFilter")?.value || "";
    const program = document.getElementById("programFilter")?.value || "";
    const openAccess = document.getElementById("openAccessFilter")?.value || "";
    const dateRangeInput = document.getElementById('dateRange')?.value || "";
let startDate = null, endDate = null;

if (dateRangeInput.includes(' - ')) {
  const [startStr, endStr] = dateRangeInput.split(' - ');

const parseDate = (str) => {
  const [month, day, year] = str.split('-');
  return new Date(`${year}-${month}-${day}`);
};

startDate = startStr ? parseDate(startStr) : null;
endDate = endStr ? parseDate(endStr) : null;
}
    
    const filtered = allData.filter(row => {
      const combinedSearch = (row["Search Combined"] || "").toLowerCase();
      const awardValue = (row["Award Number(s)"] || "").toLowerCase();
      const outputValue = (row["Output Type"] ?? "").toString().trim();
      const outputMatch = !outputType || Number(row["Output Type"]) == Number(outputType);
      const programValue = row["Funded By"] || "";
      const accessValue = row["Open Access Text"]?.trim() ? "Open Access" : "Not Open Access";
      const accessMatch = !openAccess || accessValue === openAccess;
      const pubDateStr = row["Journal Pub Date"];
      const pubDate = pubDateStr ? new Date(pubDateStr) : null;
      const dateMatch = (!startDate|| (pubDate && pubDate >= startDate)) && (!endDate || (pubDate && pubDate <= endDate));

      return (!keywordQuery || combinedSearch.includes(keywordQuery)) &&
            (!awardSearch || awardSearch
  .split(/[,;]+/) // split on comma or semicolon
  .map(term => term.trim().toLowerCase())
  .some(term => awardValue.includes(term))) &&
             (!outputType || outputValue === outputType) &&
             (!program || program === programValue) &&
             accessMatch &&
             dateMatch;
    });
filtered.sort((a, b) => {
  const dateA = a["Journal Pub Date"] ? new Date(a["Journal Pub Date"]) : new Date(0);
  const dateB = b["Journal Pub Date"] ? new Date(b["Journal Pub Date"]) : new Date(0);
  return dateB - dateA;
});
    renderCards(filtered);
  }

function updateURLParams() {
  const params = new URLSearchParams();

  const keyword = document.getElementById('searchInput')?.value.trim();
  const award = document.getElementById('searchAwardNumber')?.value.trim();
  const output = document.getElementById('outputTypeFilter')?.value;
  const program = document.getElementById('programFilter')?.value;
  const access = document.getElementById('openAccessFilter')?.value;
  const date = document.getElementById('dateRange')?.value;

  if (keyword) params.set("keyword", keyword);
  if (award) params.set("award", award);
  if (output) params.set("outputType", output);
  if (program) params.set("program", program);
  if (access) params.set("openAccess", access);
  if (date) params.set("dateRange", date);

  // Update the URL without reloading
  history.replaceState(null, "", "?" + params.toString());
}

  function formatDate(dateStr) {
  const date = new Date(dateStr);
  if (isNaN(date)) return dateStr; // Return original string if it's not a valid date

  const mm = String(date.getMonth() + 1).padStart(2, '0');
  const dd = String(date.getDate()).padStart(2, '0');
  const yyyy = String(date.getFullYear());

  return `${mm}/${dd}/${yyyy}`;
}
  
  function renderCards(data) {
  const container = document.getElementById("cardsContainer");
  const noResults = document.getElementById("noResultsMessage");
  container.innerHTML = "";
  container.className = "cards-grid";

  document.getElementById("output-count").textContent = data.length;

  if (data.length === 0) {
    noResults.style.display = "block";
    return;
  } else {
    noResults.style.display = "none";
  }
  
  data.forEach(item => {
    // NEW: Pull partnership info from CSV columns
    const isPartnership = /^(true|yes|1)$/i.test((item["Partnership?"] || "").toString().trim());
    const partnershipName = item["Partnership Name"]?.trim() || "";
    const partnerName = item["Partner Name"]?.trim() || "";
    const partnershipUrl = item["Partnership URL (if available)"]?.trim() || "";
    const partnershipLogoUrl = item["Partnership Logo URL (if available)"]?.trim() || "";

    const programLabel = isPartnership ? "WPO Partnership" : (item["Funded By"] || "");
    const awardSection = isPartnership
      ? ''
      : `<p style="font-size: 13px;"><strong>Award Number(s):</strong> ${item["Award Number(s)"]}</p>`;

    const programSection = isPartnership
      ? `<p style="font-size: 13px; display: flex; align-items: center; white-space: nowrap;">
           <span style="font-weight: bold;">Partnership:</span>
           ${
             partnershipUrl
               ? `<a href="${partnershipUrl}" target="_blank" rel="noopener noreferrer" style="margin-left: 4px; text-decoration: underline; color: #1a73e8;">
                    ${partnershipName || "Learn more"}
                  </a>`
               : `<span style="margin-left: 4px;">${partnershipName || "WPO Partnership"}</span>`
           }
         </p>`
      : `<p style="font-size: 13px; font-weight: bold; display: flex; align-items: center;">
           WPO Program: <span style="font-weight: normal; margin-left: 4px;">${programLabel}</span>
         </p>`;

    const partnerLine = isPartnership
      ? `<div style="font-size: 13px; display: flex; align-items: center; justify-content: space-between; margin-top: 4px;">
           <div style="display: flex; align-items: center;">
             <span style="font-weight: bold; color: #003366 ">Partner:</span>
             <span style="margin-left: 4px; color: #003366;">${partnerName}</span>
           </div>
           ${
             partnershipLogoUrl
               ? `<img src="${partnershipLogoUrl}" alt="Partner Logo" title="Partner Logo" style="height: 41px;" />`
               : ""
           }
         </div>`
      : '';

    const card = document.createElement("div");
    card.className = "dynamic-card";
    card.setAttribute("data-search", item["Search Combined"] || "");
    card.setAttribute("data-award", item["Award Number(s)"] || "");
    card.style = `border-left: 4px solid ${item["Link Background Color"]}; 
                  border-radius: 10px; overflow: hidden; font-family: Arial, sans-serif; 
                  margin: 10px; max-width: 600px; box-shadow: 0 2px 5px;`;

    card.innerHTML = `
      <table class="header-table" style="border-collapse: collapse; width: 100%;">
        <tr>
          <td style="color: #003d66; font-size: 20px; font-weight: bold; padding: 10px; background-color: ${item["Card Background Color"]};">
            ${item["Card Header Text"]} 
          </td>
          <td style="text-align: right; padding: 10px; background-color: ${item["Card Background Color"]};">
            <div style="display: flex; flex-direction: column; align-items: flex-end; gap: 5px;">
              <span style="display: inline-flex; align-items: center; font-size: 14px; color: #0077cc; font-weight: bold;">
                <span class="material-icons" style="font-size: 24px; margin-right: 5px;">${item["Open Access Symbol"]}</span>
                <span style="display: inline-flex; align-items: start; flex-direction: column; font-size: 10px; text-align: center;">
                  ${item["Open Access Text"]}
                </span>
              </span>
            </div>
          </td>
        </tr>
      </table>

      <div style="padding: 20px;">
        <h2 style="margin-top: 0; font-size: 17px; color: #333;">${item["Title"]}</h2>
        <p style="font-size: 13px; color: gray; font-style: italic; margin-top: 5px;">
          ${item["Principal Investigators"]} | ${formatDate(item["Journal Pub Date"])}
        </p>
        ${programSection}
        ${partnerLine}
        ${awardSection}
        <p class="abstract" style="font-size: 12px; color: #666; margin-top: 15px;">
          <strong>Abstract:</strong> ${item["Truncated Abstract"]}
        </p>
        <p style="margin-top: 20px; text-align: center;">
          <a href="${item["Link to Output"]}" target="_blank" 
             style="background-color: ${item["Link Background Color"]}; 
                    padding: 8px 15px; border-radius: 5px; color: white; font-size: 15px; text-decoration: none;">
            ${item["Link Text"]}
          </a>
        </p>
      </div>
    `;

    container.appendChild(card);
  });
}

  function resetFilters() {
    document.getElementById("searchInput").value = "";
    document.getElementById("searchAwardNumber").value = "";
    document.getElementById("outputTypeFilter").value = "";
    document.getElementById("programFilter").value = "";
    document.getElementById("openAccessFilter").value = "";
    document.getElementById("dateRange").value="";
    if (picker) picker.clearSelection();
    filterData();
  }

function downloadCSV() {
  const headers = Object.keys(allData[0]);
  const visibleCards = document.querySelectorAll('.dynamic-card');

  // Filter original data to match what's currently displayed
  const filteredData = Array.from(visibleCards).map(card => {
    const searchKey = card.getAttribute('data-search');
    const awardKey = card.getAttribute('data-award');

    return allData.find(row =>
      (row["Search Combined"] || "") === searchKey &&
      (row["Award Number(s)"] || "") === awardKey
    );
  }).filter(Boolean); // Remove any unmatched entries

  if (filteredData.length === 0) {
    alert("No data available to download.");
    return;
  }

  const csv = Papa.unparse(filteredData);

  const blob = new Blob([csv], { type: "text/csv;charset=utf-8;" });
  const url = URL.createObjectURL(blob);
  const link = document.createElement("a");

  link.setAttribute("href", url);
  link.setAttribute("download", "REACH_filtered_outputs.csv");
  document.body.appendChild(link);
  link.click();
  document.body.removeChild(link);
}

  // Kick off
  fetchData();
</script>
</body>
</html>

